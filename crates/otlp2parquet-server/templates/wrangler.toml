# Generated by otlp2parquet deploy cloudflare
# See: https://github.com/smithclay/otlp2parquet

name = "{{WORKER_NAME}}"
main = "build/worker/shim.mjs"
compatibility_date = "2025-01-15"

workers_dev = true

[build]
command = "curl -sL https://github.com/smithclay/otlp2parquet/releases/download/{{VERSION}}/otlp2parquet-worker.zip -o otlp2parquet-worker.zip && unzip -o otlp2parquet-worker.zip -d build"

[limits]
cpu_ms = 2000

[[r2_buckets]]
binding = "LOGS_BUCKET"
bucket_name = "{{BUCKET_NAME}}"

[vars]
OTLP2PARQUET_STORAGE_BACKEND = "r2"
OTLP2PARQUET_R2_BUCKET = "{{BUCKET_NAME}}"
CLOUDFLARE_ACCOUNT_ID = "{{ACCOUNT_ID}}"
OTLP2PARQUET_R2_ACCOUNT_ID = "{{ACCOUNT_ID}}"
AWS_REGION = "auto"
OTLP2PARQUET_CATALOG_MODE = "{{CATALOG_MODE}}"
{{#ICEBERG}}
CLOUDFLARE_BUCKET_NAME = "{{BUCKET_NAME}}"
{{/ICEBERG}}

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true
