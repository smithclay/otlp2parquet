{
  "summary": {
    "env": {
      "target": "x86_64-apple-darwin",
      "mode": "release",
      "commit": "823b86bf"
    },
    "workloads": [
      "small/protobuf",
      "medium/protobuf"
    ],
    "baseline": "base"
  },
  "metrics": {
    "e2e_ms_p50": 1793.86,
    "e2e_ms_p95": 1837.85,
    "throughput_rows_per_s": 5574.56,
    "alloc_bytes_total": 0,
    "max_rss_mb": 0.0,
    "lambda": {
      "cold_ms": 0,
      "warm_ms": 0,
      "package_mb": 0.0
    }
  },
  "hotspots": [],
  "batch_sensitivity": [
    {
      "batch": 4096,
      "e2e_ms": 0,
      "alloc_bytes": 0
    },
    {
      "batch": 16384,
      "e2e_ms": 0,
      "alloc_bytes": 0
    },
    {
      "batch": 65536,
      "e2e_ms": 0,
      "alloc_bytes": 0
    }
  ],
  "findings": [
    {
      "type": "alloc_bloat",
      "detail": "Redundant service_name clone in resource processing",
      "file": "crates/otlp2parquet-core/src/otlp/to_arrow.rs:289",
      "proposed_fix": "Use Arc<str> or Cow to avoid cloning service_name on every resource"
    },
    {
      "type": "alloc_bloat",
      "detail": "Found 16 builders without capacity hints",
      "file": "crates/otlp2parquet-core/src/otlp/to_arrow.rs:64-108",
      "proposed_fix": "Add with_capacity() hints based on expected batch sizes to reduce reallocation"
    },
    {
      "type": "alloc_bloat",
      "detail": "JSON serialization used for complex AnyValue types (arrays/maps)",
      "file": "crates/otlp2parquet-core/src/otlp/any_value_builder.rs:68-82",
      "proposed_fix": "Consider using Arrow native List/Map types instead of JSON strings"
    },
    {
      "type": "io_tuning",
      "detail": "Row group size hardcoded to 32k rows",
      "file": "crates/otlp2parquet-storage/src/parquet_writer.rs:76",
      "proposed_fix": "Expose as configurable parameter; test 16k, 32k, 64k for optimal throughput"
    }
  ],
  "next_actions": [
    {
      "priority": 2,
      "title": "Pre-allocate builders with capacity hints",
      "diff_hint": "ArrowConverter::new() should call .with_capacity(estimated_rows) on all builders"
    },
    {
      "priority": 3,
      "title": "Optimize service_name extraction to avoid clones",
      "diff_hint": "Change service_name field to Arc<str> or use Cow<'static, str>"
    },
    {
      "priority": 4,
      "title": "Replace JSON serialization with native Arrow types",
      "diff_hint": "Use ListBuilder/MapBuilder instead of serde_json for complex AnyValue types"
    }
  ],
  "artifacts": {
    "criterion_report": "target/criterion/report/index.html",
    "flamegraph_svg": "",
    "bloat_top": "bloat.txt",
    "tracing_json": ""
  }
}
